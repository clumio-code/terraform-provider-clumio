---
page_title: "clumio_policy_assignment Resource - terraform-provider-clumio"
subcategory: ""
description: |-
  Clumio Policy Assignment Resource used to assign (or unassign) policies.
---

# clumio_policy_assignment (Resource)

Clumio Policy Assignment Resource used to assign (or unassign) policies.

## Example Usage

### Assign Policy to Protection Group Example

```terraform
resource "clumio_policy_assignment" "example" {
  entity_id   = clumio_policy.test_policy.id
  entity_type = "protection_group"
  policy_id   = "policy_id"
}

resource "clumio_policy" "test_policy" {
  name = "test-policy"
  operations {
    action_setting = "immediate"
    type           = "aws_dynamodb_table_backup"
    slas {
      retention_duration {
        unit  = "days"
        value = 3
      }
      rpo_frequency {
        unit  = "hours"
        value = 4
      }
    }
  }
  operations {
    action_setting = "immediate"
    type           = "protection_group_backup"
    slas {
      retention_duration {
        unit  = "months"
        value = 3
      }
      rpo_frequency {
        unit  = "days"
        value = 2
      }
    }
    advanced_settings {
      protection_group_backup {
        backup_tier = "cold"
      }
    }
  }
}
```

### Assign Policy to AWS DynamoDB Table Example

```terraform
# Example using table_native_id
data "clumio_dynamodb_tables" "ds_dynamodb_tables" {
  account_native_id = "AWS Account ID"
  aws_region        = "AWS Region"
  table_native_id   = "DynamoDB table native ID"
}

resource "clumio_policy_assignment" "example" {
  entity_id   = clumio_dynamodb_tables.ds_dynamodb_tables.dynamodb_tables[0].id
  entity_type = "aws_dynamodb_table"
  policy_id   = "policy_id"
}
```

### Known Limitation
There is a known limitation with the clumio_policy_assignment resource in a particular scenario.
The below example shows a config where a policy is being created with support for protection_group_backup and aws_dynamodb_table_backup operations. When we apply this configuration, the policy will be created and the protection_group with the given entity_id will be assigned to the policy.
```terraform
resource "clumio_policy" "test_policy" {
  name = "test-policy"
  operations {
    action_setting = "immediate"
    type           = "aws_dynamodb_table_backup"
    slas {
      retention_duration {
        unit  = "days"
        value = 3
      }
      rpo_frequency {
        unit  = "hours"
        value = 4
      }
    }
  }
  operations {
    action_setting = "immediate"
    type           = "protection_group_backup"
    slas {
      retention_duration {
        unit  = "months"
        value = 3
      }
      rpo_frequency {
        unit  = "days"
        value = 2
      }
    }
    advanced_settings {
      protection_group_backup {
        backup_tier = "cold"
      }
    }
  }
}

resource "clumio_policy_assignment" "example" {
  entity_id   = "entity_id"
  entity_type = "protection_group"
  policy_id   = "policy_id"
}
```

Later when the protection_group_backup operation is removed from the policy and a `terraform apply` is done, the policy resource will be updated but there will be no changes required on the policy_assignment resource.
```terraform
resource "clumio_policy" "test_policy" {
  name = "test-policy"
  operations {
    action_setting = "immediate"
    type           = "aws_dynamodb_table_backup"
    slas {
      retention_duration {
        unit  = "days"
        value = 3
      }
      rpo_frequency {
        unit  = "hours"
        value = 4
      }
    }
  }
}

resource "clumio_policy_assignment" "example" {
  entity_id   = "entity_id"
  entity_type = "protection_group"
  policy_id   = "policy_id"
}
```
Only after the policy update is done, when a `terraform plan` is done, the policy_assignment will be removed as the policy no longer supports the protection_group_backup operation.
So essentially, the clumio_policy resource needs to be updated first before the clumio_policy_assignment resource can determine if the policy assignment to the entity is valid or not.

Note: This limitation is only in the case where both the clumio_policy and clumio_policy_assignment are part of the same state file and the policy is updated by removing the policy operation required for the assignment.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `entity_id` (String) Identifier of the resource to which the policy will be assigned.
- `entity_type` (String) Type of resource to which the policy will be assigned. `protection_group` and `aws_dynamodb_table` are currently supported.
- `policy_id` (String) Identifier of the Clumio policy to be assigned.

### Read-Only

- `id` (String) Unique identifier for the policy assignment.
